---
title: "QP状态机其一"
author: Jinkai
date: 2022-07-27 09:00:00 +0800
published: false
categories: [学习笔记]
tags: [quantum platform, QP状态机]
---

## 架构

![qp1](/assets/img/2022-07-27-quantum-platform-1/qp1.jpg)

`QF` 是一个轻量级`实时框架`，是 `QP事件驱动平台`的核心构件， QP 也包括了 `QEP层次式事件处理器`（在本书第一部分描叙），可抢占的`RTC内核(QK)`，和`软件追踪装置(QS)`。

## UML实例

对应p74

假想的 `4 层嵌套状态机`，包含了所有可能的状态转换拓扑，初始me->foo为0：

![SM_of_QHsmTst](/assets/img/2022-07-27-quantum-platform-1/SM_of_QHsmTst.png)

`状态切换`，QHSMTST.EXE实例程序运行在命令窗口。 在括号里的是供参照的行序号：

![qhsmtst](/assets/img/2022-07-27-quantum-platform-1/qhsmtst.jpg)

- 如果状态里包含大黑点和无条件的箭头，表示会自动进入箭头指向的状态，但首先要执行该状态自带的init，不论是否之前EXIT过或是ENTER过

  - 如（5）中，因为要处理D退出到了s状态，此时就需要执行s状态自带的init，再根据无条件箭头指向的s11，先进入s1再是s11

- 事件的表示

  - 事件名称(类型)
  - (可选)菱形分割
  - 监护条件(判断条件，`[]`包裹)
  - 分割号`/`
  - 动作
  - 源状态(超状态有个黑点表示本状态，表示进入此状态时无条件自动进入目标状态，状态机不能处于超状态下)
  - 目标状态
  
  示例1：`I[me->foo]/me->foo=0`，`I`为事件名称，`[me->foo]`为监护条件，分割号`/`分割了事件信息和动作，`me->foo=0`为动作。

  示例2：`e/`，`e`表示enter事件，没有对应的动作和监护条件；`x/`，`x`表示exit事件，没有对应的动作和监护条件

- `满足监护条件`才会执行对应的`状态转换`和`动作`。

- 子状态之间的状态转换需要源状态依次退出到双方的`最小共同父状态`(如s11和s211的最小共同父状态为s)，再依次进入到目的标态

## 参考

-
